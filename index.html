<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RegenCHOICE Question Manager</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>RegenCHOICE Question Manager</h1>
      <p class="subtitle">Create, manage, and validate questions</p>
    </header>

    <!-- Navigation (link-style, not buttons) -->
    <nav>
      <a href="#" id="navList" class="nav-link active">Question List</a>
      <a href="#" id="navCreate" class="nav-link">Create Question</a>
      <a href="#" id="navValidate" class="nav-link">Validate</a>
    </nav>

    <!-- Action buttons (data-changing actions) -->
    <div class="action-bar">
      <button id="saveLocalBtn" class="btn-action">Save questions locally</button>
      <button id="saveAsBtn" class="btn-action">Save with new filename</button>
      <button id="loadLocalBtn" class="btn-action">Load from file</button>
      <button id="saveServerBtn" class="btn-action" style="display:none;">Save questions to server</button>
      <button id="loadServerBtn" class="btn-action" style="display:none;">Load from server</button>
      <input type="file" id="loadFileInput" accept=".json" style="display:none;">
    </div>

    <!-- Status bar -->
    <div class="status-bar">
      <span>File: <strong id="statusFilename">regenchoice-questions.json</strong></span>
      <span>Questions: <strong id="statusCount">0</strong></span>
      <span id="statusUnsaved" style="display:none;" class="unsaved-indicator">● Unsaved changes</span>
      <span id="statusMessage" class="status-message"></span>
    </div>

    <!-- VIEWS -->

    <!-- Question List View -->
    <div id="listView" class="view active">
      <h2>Questions</h2>
      <div id="questionList"></div>
    </div>

    <!-- Create/Edit Question View -->
    <div id="createView" class="view">
      <h2 id="formTitle">Create New Question</h2>

      <form id="questionForm">
        <!-- Question Type -->
        <div class="form-group">
          <label for="questionType">Question Type *</label>
          <select id="questionType" required>
            <option value="AORBQ">AORBQ - A or B preference</option>
            <option value="FACTQ">FACTQ - Factual yes/no</option>
            <option value="LEVLQ">LEVLQ - Ordered levels</option>
            <option value="LIKSQ">LIKSQ - Likert scale</option>
            <option value="OPTSQ">OPTSQ - Options list</option>
            <option value="RANGQ">RANGQ - Numeric range</option>
            <option value="TRIPQ">TRIPQ - Triple preference</option>
          </select>
        </div>

        <!-- Common Fields -->
        <div class="form-group">
          <label for="qTitle">Question Title * (max 80 chars)</label>
          <div id="qTitle_container"></div>
        </div>

        <div class="form-group">
          <label for="qDesc">Description</label>
          <div id="qDesc_container"></div>
        </div>

        <div class="form-group">
          <label>
            <input type="checkbox" id="qRelB">
            Relational question (QRelB)
          </label>
        </div>

        <div id="qniContainer" class="form-group">
          <label for="qni">Number of items (Qni)</label>
          <input type="number" id="qni" min="2" max="10" value="5">
        </div>

        <div class="form-group">
          <label for="qLearn">Learning resource URL (QLearn)</label>
          <input type="url" id="qLearn" placeholder="https://...">
        </div>

        <!-- Enabling Questions -->
        <div class="form-section">
          <h3>Enabling Conditions (Optional)</h3>
          <div class="form-group">
            <label for="enablingQID">Enabling Question ID</label>
            <input type="number" id="enablingQID" placeholder="Question ID that enables this">
          </div>

          <div class="form-group">
            <label for="enablingAnswers">Enabling Answers</label>
            <input type="text" id="enablingAnswers" placeholder="Answer values that enable this question">
            <small>Format TBD - placeholder field</small>
          </div>
        </div>

        <!-- Type-Specific Fields (populated dynamically) -->
        <div id="typeSpecificFields"></div>

        <!-- Form Actions -->
        <div class="form-actions">
          <button type="submit" id="submitBtn" class="btn-primary">Create Question</button>
          <button type="button" id="saveNewQIDBtn" class="btn-primary" style="display:none;">Save with new QID</button>
          <button type="button" onclick="showView('list')" class="btn-secondary">Cancel</button>
        </div>
      </form>
    </div>

    <!-- Validation View -->
    <div id="validateView" class="view">
      <h2>Validation Results</h2>
      <div id="validationResults"></div>
    </div>

  </div>

  <!-- MODALS -->

  <!-- Startup Modal -->
  <div id="startupModal" class="modal" style="display:none;">
    <div class="modal-content">
      <h2>Welcome to RegenCHOICE Question Manager</h2>
      <p>How would you like to begin?</p>

      <div class="startup-options">
        <div class="startup-option">
          <h3>Load from File</h3>
          <p>Open a JSON file from your computer</p>
          <button id="startupLoadFile" class="btn-primary">Load from File</button>
          <input type="file" id="startupFileInput" accept=".json" style="display:none;">
        </div>

        <div class="startup-option" id="startupServerOption" style="display:none;">
          <h3>Load from Server</h3>
          <p>Load questions from the server</p>
          <button id="startupLoadServer" class="btn-primary">Load from Server</button>
        </div>

        <div class="startup-option">
          <h3>Start Fresh</h3>
          <p>Begin with an empty question set</p>
          <button id="startupNew" class="btn-secondary">Start Empty</button>
        </div>
      </div>
    </div>
  </div>

  <!-- View Question Modal -->
  <div id="viewModal" class="modal" style="display:none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Question JSON</h2>
        <button onclick="closeViewModal()" class="modal-close">×</button>
      </div>
      <div id="viewModalContent"></div>
    </div>
  </div>

  <!-- Validation Modal -->
  <div id="validationModal" class="modal" style="display:none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Validation Result</h2>
        <button onclick="closeValidationModal()" class="modal-close">×</button>
      </div>
      <div id="validationModalContent"></div>
    </div>
  </div>

  <!-- Load Scripts -->
  <script src="question-data.js"></script>
  <script src="app-helpers.js"></script>
  <script src="app.js"></script>
</body>
</html>
